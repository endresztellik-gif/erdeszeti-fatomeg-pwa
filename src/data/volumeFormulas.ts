/**
 * Fatérfogat számítási képlet paraméterei fafajonként
 * Forrás: https://erdoleltar.nfk.gov.hu/mintafak_faterfogatanak_szamitasa
 *
 * Képlet: v = (p1 + p2×d×h + p3×d + p4×h) × (h/(h-1.3))^k × (d²×h) / 10⁸
 *
 * Ahol:
 * - v: fatérfogat (m³)
 * - d: mellmagassági átmérő (cm)
 * - h: famagasság (m)
 * - p1, p2, p3, p4: fafaj-specifikus paraméterek
 * - k: kitevő (magasság korrekció)
 * - 1.3: tuskómagasság (m) - konstans
 */

export interface VolumeFormulaParams {
  /** Fafaj neve */
  species: string;
  /** Fafaj kódja */
  speciesCode: string;
  /** p1 paraméter (intercept) */
  p1: number;
  /** p2 paraméter (h*d kitevő) */
  p2: number;
  /** p3 paraméter (d kitevő) */
  p3: number;
  /** p4 paraméter (h kitevő) */
  p4: number;
  /** k konstans (kitevő) */
  k: number;
  /** Minimum átmérő (cm) */
  minDiameter: number;
  /** Maximum átmérő (cm) - ha null, nincs felső korlát */
  maxDiameter: number | null;
  /** Minimum magasság (m) */
  minHeight: number;
  /** Maximum magasság (m) - ha null, nincs felső korlát */
  maxHeight: number | null;
}

/**
 * Fafaj-specifikus képlet paraméterek
 * Adatok: "Összesfára" (all trees) paraméterek
 * Forrás: https://erdoleltar.nfk.gov.hu - Állófa köböző függvény paraméterei
 */
export const volumeFormulas: Record<string, VolumeFormulaParams> = {
  blackLocust: {
    species: 'Akác',
    speciesCode: 'AK',
    p1: 3.2003e3,
    p2: 2.9442e-1,
    p3: -1.8069,
    p4: -8.4771,
    k: 4,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  beech: {
    species: 'Bükk',
    speciesCode: 'B',
    p1: 4.6130e3,
    p2: 7.1602e-1,
    p3: -5.2382,
    p4: -3.4003e1,
    k: 1,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  turkeyOak: {
    species: 'Cser',
    speciesCode: 'CS',
    p1: 3.5023e3,
    p2: -1.5094e-1,
    p3: 8.3832,
    p4: 1.3218,
    k: 2,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  blackWalnut: {
    species: 'Fekete dió',
    speciesCode: 'FD',
    p1: 2.6353e3,
    p2: -6.5142e-1,
    p3: 3.5781e1,
    p4: 1.0963e1,
    k: 4,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  hornbeam: {
    species: 'Gyertyán',
    speciesCode: 'GY',
    p1: 2.6863e3,
    p2: -6.6721e-1,
    p3: 4.9944e1,
    p4: 2.2083e1,
    k: 2,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  maple: {
    species: 'Juharok',
    speciesCode: 'JH',
    p1: 4.1732e3,
    p2: -8.4755e-3,
    p3: 4.9389e-1,
    p4: -8.4324,
    k: 1,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  pedunculateOak: {
    species: 'Kocsányos tölgy',
    speciesCode: 'KT',
    p1: 2.3979e3,
    p2: -5.2279e-1,
    p3: 2.5230e1,
    p4: 2.5880e1,
    k: 4,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  sessileOak: {
    species: 'Kocsánytalan tölgy',
    speciesCode: 'KTT',
    p1: 2.7771e3,
    p2: -7.5112e-1,
    p3: 3.1496e1,
    p4: 3.0352e1,
    k: 3,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  ash: {
    species: 'Kőris',
    speciesCode: 'KR',
    p1: 2.8171e3,
    p2: 6.2094e-2,
    p3: -1.0991,
    p4: 1.9500e1,
    k: 3,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  redOak: {
    species: 'Vörös tölgy',
    speciesCode: 'VT',
    p1: 4.4289e3,
    p2: 2.0855e-1,
    p3: -1.2585e1,
    p4: -1.2265e1,
    k: 1,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  agathePoplar: {
    species: 'Agathe-F nyár',
    speciesCode: 'AGF',
    p1: 2.2920e3,
    p2: 1.4296e-1,
    p3: -6.3633,
    p4: 3.0914e1,
    k: 4,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  alder: {
    species: 'Éger',
    speciesCode: 'EG',
    p1: 3.6318e3,
    p2: -2.5983e-2,
    p3: 2.7393,
    p4: 1.5578,
    k: 1,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  whiteWillow: {
    species: 'Fehér fűz',
    speciesCode: 'FF',
    p1: 3.2188e3,
    p2: 1.4227e-1,
    p3: -3.7035,
    p4: -1.1502e1,
    k: 3,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  whitePoplar: {
    species: 'Fehér nyár',
    speciesCode: 'FN',
    p1: 3.1848e3,
    p2: -3.4369e-1,
    p3: 1.0211e1,
    p4: 2.4682,
    k: 3,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  blackPoplar: {
    species: 'Fekete nyár',
    speciesCode: 'FKN',
    p1: 3.4216e3,
    p2: -9.6765e-2,
    p3: 3.1602,
    p4: -9.3335,
    k: 2,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  linden: {
    species: 'Hársak',
    speciesCode: 'HR',
    p1: 4.1422e3,
    p2: 1.3081e-1,
    p3: -2.7146,
    p4: -1.9825e1,
    k: 1,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  i214Poplar: {
    species: 'I-214 nyár',
    speciesCode: 'I214',
    p1: 2.3411e3,
    p2: -1.3816e-1,
    p3: 1.4439e1,
    p4: 1.5625e1,
    k: 4,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  latePoplar: {
    species: 'Kései nyár',
    speciesCode: 'KN',
    p1: 2.6780e3,
    p2: -3.5070e-1,
    p3: 1.0302e1,
    p4: 1.2449e1,
    k: 3,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  earlyPoplar: {
    species: 'Korai nyár',
    speciesCode: 'KRN',
    p1: 2.7200e3,
    p2: -1.5568e-1,
    p3: 8.4776,
    p4: 6.3624,
    k: 2,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  silverBirch: {
    species: 'Közönséges nyír',
    speciesCode: 'NY',
    p1: 4.7389e3,
    p2: 1.1636,
    p3: -3.5994e1,
    p4: -4.0625e1,
    k: 1,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  giantPoplar: {
    species: 'Óriás nyár',
    speciesCode: 'ON',
    p1: 3.1991e3,
    p2: -1.4467e-1,
    p3: 7.3741,
    p4: 7.8955e-1,
    k: 2,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  aspen: {
    species: 'Rezgő nyár',
    speciesCode: 'RN',
    p1: 2.9624e3,
    p2: -3.9647e-1,
    p3: 1.5260e1,
    p4: 1.4990e1,
    k: 3,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  douglasFir: {
    species: 'Duglászfenyő',
    speciesCode: 'DF',
    p1: 3.8939e3,
    p2: 2.5449e-1,
    p3: -1.8017e1,
    p4: -8.1867,
    k: 3,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  scotsPine: {
    species: 'Erdeifenyő',
    speciesCode: 'EF',
    p1: 3.2381e3,
    p2: 5.1273e-2,
    p3: 5.7325,
    p4: -1.4593e1,
    k: 4,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  austrianPine: {
    species: 'Feketefenyő',
    speciesCode: 'FF',
    p1: 3.3482e3,
    p2: -2.2665e-1,
    p3: 1.1599e1,
    p4: -3.0405,
    k: 4,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  silverFir: {
    species: 'Jegenyefenyő',
    speciesCode: 'JF',
    p1: 5.3501e3,
    p2: -1.2820e-2,
    p3: 1.0617,
    p4: -3.9182e1,
    k: 1,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  spruce: {
    species: 'Lucfenyő',
    speciesCode: 'LF',
    p1: 3.9833e3,
    p2: -1.5907e-1,
    p3: -8.3139,
    p4: 5.0847,
    k: 3,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
  larch: {
    species: 'Vörösfenyő',
    speciesCode: 'VF',
    p1: 2.6830e3,
    p2: 4.8460e-3,
    p3: -1.4928e1,
    p4: 4.0281e1,
    k: 3,
    minDiameter: 6,
    maxDiameter: null,
    minHeight: 5,
    maxHeight: null,
  },
};

/**
 * Fafaj kulcsok típusa
 */
export type SpeciesKey = keyof typeof volumeFormulas;

/**
 * Fafajok listája (dropdown-hoz) - ABC sorrendben
 */
export const speciesList = [
  { key: 'agathePoplar' as const, name: 'Agathe-F nyár', code: 'AGF' },
  { key: 'blackLocust' as const, name: 'Akác', code: 'AK' },
  { key: 'beech' as const, name: 'Bükk', code: 'B' },
  { key: 'turkeyOak' as const, name: 'Cser', code: 'CS' },
  { key: 'douglasFir' as const, name: 'Duglászfenyő', code: 'DF' },
  { key: 'alder' as const, name: 'Éger', code: 'EG' },
  { key: 'scotsPine' as const, name: 'Erdeifenyő', code: 'EF' },
  { key: 'blackWalnut' as const, name: 'Fekete dió', code: 'FD' },
  { key: 'austrianPine' as const, name: 'Feketefenyő', code: 'FF' },
  { key: 'blackPoplar' as const, name: 'Fekete nyár', code: 'FKN' },
  { key: 'whiteWillow' as const, name: 'Fehér fűz', code: 'FF' },
  { key: 'whitePoplar' as const, name: 'Fehér nyár', code: 'FN' },
  { key: 'hornbeam' as const, name: 'Gyertyán', code: 'GY' },
  { key: 'linden' as const, name: 'Hársak', code: 'HR' },
  { key: 'i214Poplar' as const, name: 'I-214 nyár', code: 'I214' },
  { key: 'silverFir' as const, name: 'Jegenyefenyő', code: 'JF' },
  { key: 'maple' as const, name: 'Juharok', code: 'JH' },
  { key: 'latePoplar' as const, name: 'Kései nyár', code: 'KN' },
  { key: 'pedunculateOak' as const, name: 'Kocsányos tölgy', code: 'KT' },
  { key: 'sessileOak' as const, name: 'Kocsánytalan tölgy', code: 'KTT' },
  { key: 'earlyPoplar' as const, name: 'Korai nyár', code: 'KRN' },
  { key: 'ash' as const, name: 'Kőris', code: 'KR' },
  { key: 'silverBirch' as const, name: 'Közönséges nyír', code: 'NY' },
  { key: 'spruce' as const, name: 'Lucfenyő', code: 'LF' },
  { key: 'giantPoplar' as const, name: 'Óriás nyár', code: 'ON' },
  { key: 'aspen' as const, name: 'Rezgő nyár', code: 'RN' },
  { key: 'redOak' as const, name: 'Vörös tölgy', code: 'VT' },
  { key: 'larch' as const, name: 'Vörösfenyő', code: 'VF' },
] as const;
